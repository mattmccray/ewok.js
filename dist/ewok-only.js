(function(){var h,i,k,j,l=[].slice;k=window.console&&console.log?true:false;h=(function(){try{console.log.apply(console,["[Ewok] waking up..."]);return true}catch(ex){console.log("NOPE!",ex);return false}})();j=function(e){var g;g={};g.log=k?h?function(){var a;a=1<=arguments.length?l.call(arguments,0):[];a.unshift(e);return console.log.apply(console,a)}:function(){var a,b,c,d,f;b=1<=arguments.length?l.call(arguments,0):[];console.log(e);f=[];for(c=0,d=b.length;c<d;c++){a=b[c];f.push(console.log(a))}return f}:function(){};return g};i=function(a){if(a.charAt(0)==="#"){return $(a).text()}else{return a}};this.Ewok={VERSION:"0.2",exports:function(a){_.extend(this,a);return this},eventable:function(a){_.extend(a,Backbone.Events);a.fire=a.trigger;return this},loggable:function(a,b){if(b==null){b=""}_.extend(a,j(b));return this},fetchTemplate:(function(b,c){if(b){return function(a){return Settee(i(a))}}else if(c){return function(a){return Hogan.compile(i(a))}}else{return function(a){return _.template(i(a))}}})(typeof Settee!=="undefined"&&Settee!==null,typeof Hogan!=="undefined"&&Hogan!==null)};Ewok.loggable(Ewok);Ewok.eventable(Ewok)}).call(this);(function(){var g,h,i,k=function(a,b){return function(){return a.apply(b,arguments)}},j=[].slice,l={}.hasOwnProperty;g=(function(){f.route=function(a,b){if(b==null){b={}}this.routeMap||(this.routeMap={});return this.routeMap[a]=b};f.use_view=function(b){return{enter:function(){var a;a=1<=arguments.length?j.call(arguments,0):[];return this.app.showView(b,{params:this.params})},leave:function(){var a;a=1<=arguments.length?j.call(arguments,0):[]}}};f.call_method=function(d){return{enter:function(){var a,b,c;b=2<=arguments.length?j.call(arguments,0,c=arguments.length-1):(c=0,[]),a=arguments[c++];return a[d](true,b)},leave:function(){var a,b,c;b=2<=arguments.length?j.call(arguments,0,c=arguments.length-1):(c=0,[]),a=arguments[c++];return a[d](false,b)}}};f.run=function(a){if(this.instance==null){this.instance=new this;return this.instance.run(a)}else{this.instance.log("Already running!");return this.instance}};function f(){this._willInitialize=k(this._willInitialize,this);var a;this.el||(this.el='body');a=this.constructor.name?"["+this.constructor.name+"]":'[App]';Ewok.loggable(this,a);this.stateMap=this.constructor.stateMap||{};this.routeMap=this.constructor.routeMap||{};this._buildRouter()}f.prototype._buildRouter=function(){var a,b,c,d;this.router=new Backbone.Router();d=this.routeMap;for(b in d){if(!l.call(d,b))continue;a=d[b];c=new h(this,b,a);this.router.route(b,null,this._routeChange(c));this.routeMap[b]=c}return this};f.prototype._willInitialize=function(){if(_.isString(this.el)){this.el=$(this.el)}if(this.initialize){this.initialize()}this.fire('app:init',{app:this});if(Backbone.history){Backbone.history.start()}else{this.log("No routes defined! Not starting Backbone.history")}return this.fire('app:run')};f.prototype._routeChange=function(b){var c=this;return function(){var a;a=1<=arguments.length?j.call(arguments,0):[];if(c._currentRoute){c._currentRoute.doLeave(a)}c._currentRoute=b;return c._currentRoute.doEnter(a)}};f.prototype.visit=function(a,b){if(b==null){b=false}return this.router.navigate(a,{trigger:true,replace:b})};f.prototype.history=function(a,b){if(b==null){b=false}return this.router.navigate(a,{trigger:false,replace:b})};f.prototype.showView=function(a,b){if(b==null){b={}}a=_.isFunction(a)?(b.app=this,new a(b)):(a.app=this,a);a.render();if(this.activeView){this.activeView.close()}this.el.html("");this.el.append(a.el);this.activeView=a;a.show();return this};f.prototype.run=function(a){this.options=a!=null?a:{};if(this.options.el){this.el=this.options.el}if(!this.options.immediate){$(this._willInitialize)}else{this._willInitialize()}return this};return f})();i=/:\w+/g;h=(function(){function e(a,b,c){var d,f;this.app=a;this.path=b;if(_.isFunction(c)){c=c()||{}}for(d in c){if(!l.call(c,d))continue;f=c[d];this[d]=f}}e.prototype.enter=function(){};e.prototype.leave=function(){};e.prototype.doEnter=function(a){this.params=this.argsToHash(a);a.push(this.app);return this.enter.apply(this,a)};e.prototype.doLeave=function(a){a.push(this.app);this.leave.apply(this,a);return this.params={}};e.prototype.argsToHash=function(c){var d,f;d={};f=this.path.match(i);_.each(f,function(a,b){return d[a.slice(1)]=c[b]});return d};return e})();Ewok.eventable(g.prototype).exports({App:g})}).call(this);(function(){var g,h={}.hasOwnProperty,i=function(a,b){for(var c in b){if(h.call(b,c))a[c]=b[c]}function ctor(){this.constructor=a}ctor.prototype=b.prototype;a.prototype=new ctor();a.__super__=b.prototype;return a},k=[].slice;g=(function(f){i(e,f);function e(a){var b,c,d;if(this.templates){d=this.templates;for(b in d){if(!h.call(d,b))continue;c=d[b];this.templates[b]=this.fetchTemplate(c)}}e.__super__.constructor.call(this,a)}e.prototype._configure=function(a){e.__super__._configure.call(this,a);if(this.options.parent){this.parent=this.options.parent}if(this.options.params){this.params=this.options.params}if(this.options.app){this.app=this.options.app}if(!this.id){this.id=this.cid}if(!this.className){return this.className="ewok-view"}};e.prototype.setElement=function(a,b){e.__super__.setElement.call(this,a,b);this.$el.data('view',this);return this};e.prototype.attach=function(a,b){var c,d;this._attached||(this._attached=[]);for(d in b){if(!h.call(b,d))continue;c=b[d];a.on(d,c);this._attached.push({target:a,event:d,callback:c})}return this};e.prototype.detach=function(){var a,b,c,d;if(this._attached){d=this._attached;for(b=0,c=d.length;b<c;b++){a=d[b];a.target.off(a.event,a.callback)}}this._attached=[];return this};e.prototype.addView=function(a,b){if(b==null){b={}}this._views||(this._views=[]);if(_.isFunction(a)){a=new a(b)}a.parent=this;this._views.push(a);a.render(this);return a};e.prototype.close=function(){var a,b,c,d;this.unbind();this.detach();if(this._views){d=this._views;for(b=0,c=d.length;b<c;b++){a=d[b];a.close()}}this.$el.data('view',null);this.remove();if(this.onClose){this.onClose()}return this};e.prototype.log=function(){var a,b;a=1<=arguments.length?k.call(arguments,0):[];b=this.constructor.name?"["+this.constructor.name+"]":'[View]';Ewok.loggable(this,b);return this['log'].apply(this,a)};e.prototype.show=function(){if(this.onShow){this.onShow()}return this};e.prototype.render=function(){var a;if(this.templates.main){a=this.model!=null?this.model.toJSON?this.model.toJSON():this.model:this.params?this.params:this.collection?{items:this.collection.toJSON()}:{};return this.$el.html(this.templates.main(a))}};e.prototype.fetchTemplate=function(a){if(_.isString(a)){return Ewok.fetchTemplate(a)}else{return a}};return e})(Backbone.View);Ewok.exports({View:g});$.fn.view=function(){var a,b;b=null;a=$(this);while(!b&&a.length>0){b=a.data('view');if(!b){a=a.parent()}}return b}}).call(this);(function(){var d,f={}.hasOwnProperty,e=function(a,b){for(var c in b){if(f.call(b,c))a[c]=b[c]}function ctor(){this.constructor=a}ctor.prototype=b.prototype;a.prototype=new ctor();a.__super__=b.prototype;return a};d=(function(a){e(b,a);function b(){return b.__super__.constructor.apply(this,arguments)}return b})(Backbone.Model);Ewok.exports({Model:d})}).call(this);(function(){var d,f={}.hasOwnProperty,e=function(a,b){for(var c in b){if(f.call(b,c))a[c]=b[c]}function ctor(){this.constructor=a}ctor.prototype=b.prototype;a.prototype=new ctor();a.__super__=b.prototype;return a};d=(function(a){e(b,a);function b(){return b.__super__.constructor.apply(this,arguments)}return b})(Backbone.Collection);Ewok.exports({Collection:d})}).call(this);